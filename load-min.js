!function(){let e="https://logs.brx.rate-match.com/api/log/error",t="https://logs.brx.rate-match.com/api/log/api",n=[];function o(){if(0===n.length)return;let e=JSON.stringify(n);console.log("Sending batch logs:",n),navigator.sendBeacon?navigator.sendBeacon(t,e):fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:e}).catch(e=>console.warn("Fallback log send failed",e)),n=[]}function a(e){n.push(e),console.log("Added API log to batch:",e),n.length>=5&&o()}setInterval(o,5e3),window.addEventListener("error",function(t){let n=t,o={type:"runtimeError",message:n.message||"",stack:n.error?.stack||"No stack available",source:n.filename||"",lineno:n.lineno||0,colno:n.colno||0,url:window.location.href,user_agent:navigator.userAgent,timestamp:new Date().toISOString()};console.error("Runtime error caught:",o),navigator.sendBeacon?navigator.sendBeacon(e,JSON.stringify(o)):fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)}).catch(e=>console.warn("Fallback error send failed",e))}),window.addEventListener("unhandledrejection",function(t){let n=t.reason||{},o={type:"unhandledRejection",message:n.message||String(n),stack:n.stack||"No stack available",url:window.location.href,user_agent:navigator.userAgent,timestamp:new Date().toISOString()};console.error("Unhandled rejection caught:",o),navigator.sendBeacon?navigator.sendBeacon(e,JSON.stringify(o)):fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)}).catch(e=>console.warn("Fallback error send failed",e))});let r=window.fetch;window.fetch=async function(...e){let[t,n]=e,o=n&&n.method||"GET",s="string"==typeof t?t:t.url,i=performance.now();try{let l=await r(...e),c=performance.now()-i;if(c>500){let d={type:"apiRequest",method:o,url:s,status:l.status,response_time_ms:parseFloat(c.toFixed(2)),user_agent:navigator.userAgent,timestamp:new Date().toISOString()};a(d)}return l}catch(p){let g=performance.now()-i,u={type:"apiError",method:o,url:s,error:p.message,response_time_ms:parseFloat(g.toFixed(2)),user_agent:navigator.userAgent,timestamp:new Date().toISOString()};throw a(u),p}},function(){let e=XMLHttpRequest.prototype.open,t=XMLHttpRequest.prototype.send;XMLHttpRequest.prototype.open=function(t,n){return this._logData={method:t,url:n},e.apply(this,arguments)},XMLHttpRequest.prototype.send=function(e){let n=this,o=performance.now();return n.addEventListener("loadend",function(){let e=performance.now()-o;if(e>500){let t={type:"xhrRequest",method:n._logData.method,url:n._logData.url,status:n.status,response_time_ms:parseFloat(e.toFixed(2)),user_agent:navigator.userAgent,timestamp:new Date().toISOString()};a(t)}}),t.apply(this,arguments)}}()}();
